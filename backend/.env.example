# Backend environment template
# Copy to `.env` for local development or map these keys to your deployment secret store.
# Values shown here are safe defaults or placeholders. Override them per environment.

########################################
# Google Cloud / Vertex AI configuration
########################################
# Required: GCP project that hosts Vertex AI, BigQuery, and related resources.
PROJECT_ID=
# Optional override; defaults to `us-central1` if omitted.
VERTEX_AI_REGION=us-central1
# Service account credentials used to authenticate to GCP services when running locally.
# Provide an absolute path to a JSON key file *outside* the repo, or mount credentials via Secret Manager.
# In production (Cloud Run, GKE, etc.) prefer Workload Identity Federation and omit this variable.
GOOGLE_APPLICATION_CREDENTIALS=/absolute/path/to/service-account.json

########################################
# Data sources (BigQuery tables, embeddings)
########################################
BIGQUERY_DATASET_ID=
BIGQUERY_PRODUCT_TABLE=product_embeddings
BIGQUERY_REVIEW_TABLE=review_embeddings
# Optional per-feature model overrides.
SENTIMENT_MODEL_NAME=

########################################
# LLM configuration
########################################
LLM_MODEL_NAME=gemini-2.0-flash-lite
# Optional tokenizer override used by the RAG pipeline when truncating context windows.
RAG_TIKTOKEN_ENCODING=cl100k_base

########################################
# RAG batching / prompt shaping defaults
########################################
RAG_BATCHING_ENABLED=true
RAG_BATCH_SIZE=3
RAG_MAX_PROMPT_TOKENS=65536
RAG_MAX_REVIEW_CHARS=4000

########################################
# Application auth & rate limits
########################################
# Backend also checks NEXTAUTH_SECRET if APP_JWT_SECRET is unset to mirror the NextAuth setup.
# For local development, set `APP_JWT_SECRET` here or set `NEXTAUTH_SECRET` in the frontend `.env.local`.
# It's recommended to use the same secret value for both to avoid mismatches between frontend and backend session signing.
APP_JWT_SECRET=
APP_JWT_ALGORITHM=HS256
APP_JWT_ISSUER=rag-recommender
APP_JWT_AUDIENCE=rag-recommender
# Rate limits and guest token expiry
GUEST_ACCESS_TOKEN_TTL_SECONDS=600
GUEST_SESSION_RATE_LIMIT=5/minute
GUEST_SEARCH_RATE_LIMIT=20/minute
USER_SEARCH_RATE_LIMIT=60/minute
ADMIN_SEARCH_RATE_LIMIT=120/minute

########################################
# Refresh token storage (choose one backend)
########################################
# Default TTLs (seconds) can be overridden here.
REFRESH_SESSION_TTL=604800
REFRESH_BLACKLIST_TTL=172800

# Option A: Vercel KV / Upstash REST API (recommended for Vercel deployments)
KV_REST_API_URL=
KV_REST_API_TOKEN=
# Optional namespace to prefix keys (e.g. "production").
VERCEL_KV_NAMESPACE=
VERCEL_KV_REST_API_URL=
VERCEL_KV_REST_API_TOKEN=
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Option B: Redis connection string (used when REST credentials are not provided)
REDIS_URL=
UPSTASH_REDIS_URL=

########################################
# Observability / optional integrations
########################################
LOG_LEVEL=info
SENTRY_DSN=

########################################
# Local development helpers
########################################
ENABLE_DEBUG=false

